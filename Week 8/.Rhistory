#PC0 Load the Week 3 Dataset
library(readr)
week3_dataset_kevin <- read_csv("~/Google Drive/GitHub/Kevin/Week 3/week3_dataset-kevin.csv")
View(week3_dataset_kevin)
#PC1
#Run a t-test on x and y. The results reveal that their relationship is statistically significant at the p<.000 level.
t.test(week3_dataset_kevin$x, week3_dataset_kevin$y)
#PC2 I would estimate that x and y are highly correlated with one another. The correlation function shows a correlation coeffecient of .872
plot(week3_dataset_kevin$x, week3_dataset_kevin$y)
cor(week3_dataset_kevin$x, week3_dataset_kevin$y) #.872 correlation
cor(week3_dataset_kevin$x, week3_dataset_kevin$y, method="spearman") #.854 correlation
#PC3 Recode the data
tmp.week3_dataset <- week3_dataset_kevin
class(tmp.week3_dataset$x)
x <- tmp.week3_dataset$x
y <- tmp.week3_dataset$y
i <- as.logical(tmp.week3_dataset$i)
i
class(i)
j <- as.logical(tmp.week3_dataset$j)
j
class(j)
k <- factor(tmp.week3_dataset$k, labels = c("none", "some", "lots", "all"))
k
class(k)
#PC4 Create linear models
yxlm <- lm(y ~ x, data = tmp.week3_dataset)
yxlm.i <- lm(y ~ x + i, data = tmp.week3_dataset)
yxlm.ij <- lm(y ~ x + i + j, data = tmp.week3_dataset)
yxlm.full <- lm(y ~ x + i + j + k, data = tmp.week3_dataset)
#Show a table of the results of the models
summary(yxlm)
summary(yxlm.i)
summar(yxlm.ij)
summary(yxlm.full)
#Find the r^2 for the models
summary(yxlm)$r.squared
summary(yxlm.i)$r.squared
summary(yxlm.ij)$r.squared
summary(yxlm.full)$r.squared
#PC5 Create histograms and plots for the residuals
#Histogram
hist(residuals(yxlm))
#Plots
plot(x, residuals(yxlm))
plot(i, residuals(yxlm))
plot(j, residuals(yxlm))
plot(k, residuals(yxlm))
#QQNorm
qqnorm(residuals(yxlm))
#QQPlot
yxlm.graph <- data.frame(x = tmp.week3_dataset$y, residuals = residuals(yxlm))
yxlm.graph
library(ggplot2)
ggplot(data=yxlm.graph) + aes(x=x, y=residuals) +geom_point()
#PC6 Create a publication ready table
library(stargazer)
stargazer(yxlm.full, type = "text")
#PC7 Load the data set and write linear models
library(haven)
Halloween2012_2014_2015_PLOS <- read_dta("~/Google Drive/GitHub/Kevin/Week 7/Halloween2012-2014-2015_PLOS.dta")
View(Halloween2012_2014_2015_PLOS)
#PC7a
fruit <- Halloween2012_2014_2015_PLOS$fruit
obama <- Halloween2012_2014_2015_PLOS$obama
fruit.obama <- lm(fruit ~ obama, data = Halloween2012_2014_2015_PLOS)
fruit.obama
summary(fruit.obama)
#P7b
age <- Halloween2012_2014_2015_PLOS$age
year <- as.factor(Halloween2012_2014_2015_PLOS$year)
control.fruit.obama <- lm(fruit ~ obama + age + year, data = Halloween2012_2014_2015_PLOS)
control.fruit.obama
summary(control.fruit.obama)
#PC8
hist(residuals(fruit.obama))
plot(residuals(fruit.obama))
qqnorm(residuals(fruit.obama))
fruit.obama.graph <- data.frame(x = Halloween2012_2014_2015_PLOS$fruit, residuals = residuals(fruit.obama))
yxlm.graph
library(ggplot2)
ggplot(data=yxlm.graph) + aes(x=x, y=residuals) +geom_point()
#PC9 Create subsets of the data for 2012, 2014, and 2015 and run model
d.2012 <- subset(Halloween2012_2014_2015_PLOS, year == 2012)
d.2014 <- subset(Halloween2012_2014_2015_PLOS, year == 2014)
d.2015 <- subset(Halloween2012_2014_2015_PLOS, year == 2015)
fruit.2012 <- d.2012$fruit
obama.2012 <- d.2012$obama
fruit.2014 <- d.2014$fruit
obama.2014 <- d.2014$obama
fruit.2015 <- d.2015$fruit
obama.2015 <- d.2015$obama
fruit.obama.2012 <- lm(fruit.2012 ~ obama.2012, data = d.2012)
fruit.obama.2012
summary(fruit.obama.2012)
fruit.obama.2014 <- lm(fruit.2014 ~ obama.2014, data = d.2014)
fruit.obama.2014
summary(fruit.obama.2014)
fruit.obama.2015 <- lm(fruit.2015 ~ obama.2015, data = d.2015)
fruit.obama.2015
summary(fruit.obama.2015)
fruit.obama <- lm(obama ~ fruit, data = Halloween2012_2014_2015_PLOS)
fruit.obama
summary(fruit.obama)
fruit.obama <- lm(fruit ~ obama, data = Halloween2012_2014_2015_PLOS)
fruit.obama
summary(fruit.obama)
fruit.obama <- lm(obama ~ fruit, data = Halloween2012_2014_2015_PLOS)
fruit.obama
summary(fruit.obama)
fruit <- Halloween2012_2014_2015_PLOS$fruit
obama <- Halloween2012_2014_2015_PLOS$obama
fruit.obama <- lm(fruit ~ obama, data = Halloween2012_2014_2015_PLOS)
fruit.obama
summary(fruit.obama)
library(stargazer)
stargazer(yxlm.full, type = "text")
fruit <- Halloween2012_2014_2015_PLOS$fruit
obama <- Halloween2012_2014_2015_PLOS$obama
fruit.obama <- lm(fruit ~ obama, data = Halloween2012_2014_2015_PLOS)
fruit.obama
summary(fruit.obama)
age <- Halloween2012_2014_2015_PLOS$age
year <- as.factor(Halloween2012_2014_2015_PLOS$year)
control.fruit.obama <- lm(fruit ~ obama + age + year, data = Halloween2012_2014_2015_PLOS)
control.fruit.obama
summary(control.fruit.obama)
age <- Halloween2012_2014_2015_PLOS$age
year <- as.factor(Halloween2012_2014_2015_PLOS$year)
control.fruit.obama <- lm(fruit ~ obama + age + year, data = Halloween2012_2014_2015_PLOS)
control.fruit.obama
summary(control.fruit.obama)
year
table(year)
table(Halloween2012_2014_2015_PLOS$treat_year)
class(Halloween2012_2014_2015_PLOS$treat_year)
age <- Halloween2012_2014_2015_PLOS$age
year <- as.factor(Halloween2012_2014_2015_PLOS$year)
control.fruit.obama <- lm(fruit ~ obama + age + year, data = Halloween2012_2014_2015_PLOS)
control.fruit.obama
summary(control.fruit.obama)
fruit <- Halloween2012_2014_2015_PLOS$fruit
obama <- Halloween2012_2014_2015_PLOS$obama
fruit.obama <- lm(fruit ~ obama, data = Halloween2012_2014_2015_PLOS)
fruit.obama
summary(fruit.obama)
hist(residuals(fruit.obama))
plot(residuals(fruit.obama))
qqnorm(residuals(fruit.obama))
fruit.obama.graph <- data.frame(x = Halloween2012_2014_2015_PLOS$fruit, residuals = residuals(fruit.obama))
yxlm.graph
library(ggplot2)
ggplot(data=yxlm.graph) + aes(x=x, y=residuals) +geom_point()
d.2012 <- subset(Halloween2012_2014_2015_PLOS, year == 2012)
d.2014 <- subset(Halloween2012_2014_2015_PLOS, year == 2014)
d.2015 <- subset(Halloween2012_2014_2015_PLOS, year == 2015)
fruit.2012 <- d.2012$fruit
obama.2012 <- d.2012$obama
fruit.2014 <- d.2014$fruit
obama.2014 <- d.2014$obama
fruit.2015 <- d.2015$fruit
obama.2015 <- d.2015$obama
fruit.obama.2012 <- lm(fruit.2012 ~ obama.2012, data = d.2012)
fruit.obama.2012
summary(fruit.obama.2012)
fruit.obama.2014 <- lm(fruit.2014 ~ obama.2014, data = d.2014)
fruit.obama.2014
summary(fruit.obama.2014)
fruit.obama.2015 <- lm(fruit.2015 ~ obama.2015, data = d.2015)
fruit.obama.2015
summary(fruit.obama.2015)
#Load the CC Communications and Spoken Communications datasets
library(readxl)
CC_Communications <- read_excel("~/Google Drive/University Work/UW (PhD)/DRG/CC Communications.xlsx")
View(CC_Communications)
library(readxl)
Spoken_Communications <- read_excel("~/Google Drive/University Work/UW (PhD)/DRG/Spoken Communications.xlsx")
View(Spoken_Communications)
#Create subsets of data based on the individual presidents from both data sets. HW Bush = 1,
##Clinton = 2, W Bush = 3, Obama = 4.
hwbush.sc <- subset(Spoken_Communications, President == 1)
clinton.sc <- subset(Spoken_Communications, President == 2)
wbush.sc <- subset(Spoken_Communications, President == 3)
obama.sc <- subset(Spoken_Communications, President == 4)
hwbush.cc <- subset(CC_Communications, President == 1)
clinton.cc <- subset(CC_Communications, President == 2)
wbush.cc <-subset(CC_Communications, President == 3)
obama.cc <-subset(CC_Communications, President == 4)
#Calculate summary statistics for the variables
###Party - calculate the mode
table(CC_Communications$Party)
###President - calculate the mode
table(CC_Communications$President)
###CC Invocations - calculate mean and SD
summary(CC_Communications$`CC Invo#`)
sd(CC_Communications$`CC Invo#`)
summary(hwbush.cc$`CC Invo#`)
sd(hwbush.cc$`CC Invo#`)
summary(clinton.cc$`CC Invo#`)
sd(clinton.cc$`CC Invo#`)
summary(wbush.cc$`CC Invo#`)
sd(wbush.cc$`CC Invo#`)
summary(obama.cc$`CC Invo#`)
sd(obama.cc$`CC Invo#`)
###Domestic/Foreign - calculate the mode
table(CC_Communications$`Dom/Foreign`)
table(hwbush.cc$`Dom/Foreign`)
table(clinton.cc$`Dom/Foreign`)
table(wbush.cc$`Dom/Foreign`)
table(obama.cc$`Dom/Foreign`)
###Audience - calculate the mode
table(CC_Communications$Audience)
table(hwbush.cc$Audience)
table(clinton.cc$Audience)
table(wbush.cc$Audience)
table(obama.cc$Audience)
###Communication type - calculate the mode
table(CC_Communications$CommType)
table(hwbush.cc$CommType)
table(clinton.cc$CommType)
table(wbush.cc$CommType)
table(obama.cc$CommType)
#Calculate the percentage of climate change communications each President made out of
##the total number of spoken communications.
hwbush.pctsc <- round((nrow(hwbush.cc) / (nrow(hwbush.sc) - nrow(hwbush.cc)))*100, digits = 2)
clinton.pctsc <- round((nrow(clinton.cc) / (nrow(clinton.sc) - nrow(clinton.cc)))*100, digits = 2)
wbush.pctsc <- round((nrow(wbush.cc) / (nrow(wbush.sc) - nrow(wbush.cc)))*100, digits = 2)
obama.pctsc <- round((nrow(obama.cc) / (nrow(obama.sc) - nrow(obama.cc)))*100, digits = 2)
#Calculate the percentage of climate change communiccations each President made out of
##the total number of climate change communications.
hwbush.pctcc <- round((nrow(hwbush.cc)/nrow(CC_Communications))*100, digits = 2)
clinton.pctcc <- round((nrow(clinton.cc)/nrow(CC_Communications))*100, digits = 2)
wbush.pctcc <- round((nrow(wbush.cc)/nrow(CC_Communications))*100, digits = 2)
obama.pctcc <- round((nrow(obama.cc)/nrow(CC_Communications))*100, digits = 2)
#Calculate the percentage of climate change communications for the domestic/foreign, audience, and
##communication type variables.
###Domestic/foreign variable
round((table(hwbush.cc$`Dom/Foreign`)/nrow(hwbush.cc))*100, digits = 2)
round((table(clinton.cc$`Dom/Foreign`)/nrow(clinton.cc))*100, digits = 2)
round((table(wbush.cc$`Dom/Foreign`)/nrow(wbush.cc))*100, digits = 2)
round((table(obama.cc$`Dom/Foreign`)/nrow(obama.cc))*100, digits = 2)
###Audience variable
round((table(hwbush.cc$Audience)/nrow(hwbush.cc))*100, digits = 2)
round((table(clinton.cc$Audience)/nrow(clinton.cc))*100, digits = 2)
round((table(wbush.cc$Audience)/nrow(wbush.cc))*100, digits = 2)
round((table(obama.cc$Audience)/nrow(obama.cc))*100, digits = 2)
###Communication type variable
round((table(hwbush.cc$CommType)/nrow(hwbush.cc))*100, digits = 2)
round((table(clinton.cc$CommType)/nrow(clinton.cc))*100, digits = 2)
round((table(wbush.cc$CommType)/nrow(wbush.cc))*100, digits = 2)
round((table(obama.cc$CommType)/nrow(obama.cc))*100, digits = 2)
#Perform t-test and chi square test of differences for climate change invocation, communication type, audience type,
##domestic/foreign for party and president.
###Remove scientific notation
options(scipen=999)
###Run a t-test of differences between party and climate change invocations
t.test(CC_Communications$Party, CC_Communications$`CC Invo#`)
###Run a chi-square test of differences betwee party and communication type, audience, and domestic/foreign location
chisq.test(CC_Communications$Party, CC_Communications$CommType)
chisq.test(CC_Communications$Party, CC_Communications$Audience)
chisq.test(CC_Communications$Party, CC_Communications$`Dom/Foreign`)
###Run a chi-square test of differences betwee president and communication type, audience, and domestic/foreign location
chisq.test(CC_Communications$President, CC_Communications$CommType)
chisq.test(CC_Communications$President, CC_Communications$Audience)
chisq.test(CC_Communications$President, CC_Communications$`Dom/Foreign`)
party.ccinvo <- t.test(CC_Communications$Party, CC_Communications$`CC Invo#`)
library(stargazer)
stargazer(party.ccinvo, type = "text")
fruit.obama.2012 <- lm(obama.2012 ~ fruit.2012, data = d.2012)
fruit.obama.2012
summary(fruit.obama.2012)
fruit <- Halloween2012_2014_2015_PLOS$fruit
obama <- Halloween2012_2014_2015_PLOS$obama
fruit.obama <- lm(obama ~ fruit, data = Halloween2012_2014_2015_PLOS)
fruit.obama
summary(fruit.obama)
fruit <- Halloween2012_2014_2015_PLOS$fruit
obama <- Halloween2012_2014_2015_PLOS$obama
fruit.obama <- lm(fruit ~ obama, data = Halloween2012_2014_2015_PLOS)
fruit.obama
summary(fruit.obama)
summary(yxlm)
summary(yxlm.i)
summar(yxlm.ij)
summary(yxlm.full)
summary(yxlm)
summary(yxlm.i)
summar(yxlm.ij)
summary(yxlm.ij)
summary(yxlm.full)
hist(residuals(yxlm.full))
plot(x, residuals(yxlm.full))
plot(i, residuals(yxlm.full))
plot(j, residuals(yxlm.full))
plot(k, residuals(yxlm.full))
qqnorm(residuals(yxlm.full))
yxlm.graph <- data.frame(x = tmp.week3_dataset$y, residuals = residuals(yxlm))
yxlm.graph
library(ggplot2)
ggplot(data=yxlm.graph) + aes(x=x, y=residuals) +geom_point()
qqnorm(residuals(yxlm.full))
plot(x, residuals(yxlm.full))
plot(i, residuals(yxlm.full))
plot(j, residuals(yxlm.full))
plot(k, residuals(yxlm.full))
qqnorm(residuals(yxlm.full))
yxlm.graph <- data.frame(x = tmp.week3_dataset$y, residuals = residuals(yxlm.full))
yxlm.graph
library(ggplot2)
ggplot(data=yxlm.graph) + aes(x=x, y=residuals) +geom_point()
yxlm.graph <- data.frame(x = tmp.week3_dataset$y, residuals = residuals(yxlm.full))
yxlm.graph
library(ggplot2)
qqplot(data=yxlm.graph) + aes(x=x, y=residuals) +geom_point()
qqnorm(residuals(yxlm.full))
hist(residuals(yxlm.full))
qqnorm(residuals(yxlm.full))
library(stargazer)
stargazer(yxlm.full, type = "text")
